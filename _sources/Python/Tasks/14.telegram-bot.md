# Телеграм боты

## Декораторы в телеграм ботах
Создать две команды для пользователя:
    Одна команда `/start` приветствует пользователя  
    Вторая команда `/getid` показывает пользователю его `user_id`  

Создать команду `/ban` для админа, с помощью которой можно забанить любого пользователя по его `user_id`.  
После использования этой команды, пользователь добавляется в бан-лист.  

Необходимо создать декоратор который проверяет находится ли пользователь в бан-листе и применить его к фукнциям которые вызываются командами `/start` и `/getid`.  

Дополнительно: Можно сделать команду для разбана пользователя `/unban/`

````{toggle} Click
```python

import logging

from telegram import ForceReply, Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, ContextTypes, MessageHandler, filters

# Enable logging
logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s", level=logging.INFO
)

logging.getLogger("httpx").setLevel(logging.WARNING)

logger = logging.getLogger(__name__)

TOKEN = "TOKEN"
ADMINS = []
banlist = []

def detect(func):
    async def update_func(update: Update, context: ContextTypes.DEFAULT_TYPE):
        userid = update.effective_user.id
        if userid in ADMINS:
            return await func(update, context)
        else:
            await update.message.reply_text("Вы не являетесь администратором")
    return update_func

def verification(func):
    async def update_func(update: Update, context: ContextTypes.DEFAULT_TYPE):
        userid = update.effective_user.id
        if userid not in banlist:
            return await func(update, context)
        else:
            await update.message.reply_text("Вы забанены.")
    return update_func

# @detect
@verification
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user = update.effective_user
    await update.message.reply_html(
        rf"Добро пожаловать {user.mention_html()}!"
    )

# @detect
@verification
async def admin(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    keyboard = [[InlineKeyboardButton("Newsletter", callback_data=1)],
                [InlineKeyboardButton("Edit info", callback_data=2)]]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text("Admin menu", reply_markup=reply_markup)

# @detect
@verification
async def ban(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    text = update.message.text
    ban_id = text.split()[1]
    banlist.append(int(ban_id))
    await update.message.reply_text("Пользователь %s забанен." % ban_id)

# @detect
@verification
async def getid(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_id = update.effective_user.id
    await update.message.reply_text("Ваш userid: %s" % user_id)

# @detect
async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    await update.message.reply_text("Help!")

def main() -> None:
    """Start the bot."""
    application = Application.builder().token(TOKEN).build()

    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("help", help_command))
    application.add_handler(CommandHandler("admin", admin))
    application.add_handler(CommandHandler("ban", ban))
    application.add_handler(CommandHandler("getid", getid))

    # Run the bot until the user presses Ctrl-C
    application.run_polling(allowed_updates=Update.ALL_TYPES)


if __name__ == "__main__":
    main()
```
````